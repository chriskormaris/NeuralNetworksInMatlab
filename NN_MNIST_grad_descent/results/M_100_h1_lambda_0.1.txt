M = 100
activation function = h1
lambda = 0.1
number of max iterations = 500

The number of the train data is 60000.
The number of the test data is 10000.

Running batch gradient descent...
Iteration: 1, Cost function: 193822.754106
Iteration: 2, Cost function: 182608.595267
Iteration: 3, Cost function: 159262.342581
Iteration: 4, Cost function: 141322.980000
Iteration: 5, Cost function: 127176.233491
Iteration: 6, Cost function: 122921.604284
Iteration: 7, Cost function: 118677.526334
Iteration: 8, Cost function: 115273.245913
Iteration: 9, Cost function: 112029.039626
Iteration: 10, Cost function: 108984.455477
Iteration: 11, Cost function: 106083.677617
Iteration: 12, Cost function: 103286.328914
Iteration: 13, Cost function: 100612.492028
Iteration: 14, Cost function: 98019.501246
Iteration: 15, Cost function: 95535.242566
Iteration: 16, Cost function: 93125.537575
Iteration: 17, Cost function: 90814.418761
Iteration: 18, Cost function: 88574.652611
Iteration: 19, Cost function: 86426.696508
Iteration: 20, Cost function: 84346.994036
Iteration: 21, Cost function: 82354.820346
Iteration: 22, Cost function: 80427.634961
Iteration: 23, Cost function: 78585.222347
Iteration: 24, Cost function: 76804.682179
Iteration: 25, Cost function: 75106.541758
Iteration: 26, Cost function: 73468.131926
Iteration: 27, Cost function: 71908.807305
Iteration: 28, Cost function: 70410.009646
Iteration: 29, Cost function: 68984.121460
Iteration: 30, Cost function: 67626.424113
Iteration: 31, Cost function: 66329.153871
Iteration: 32, Cost function: 65121.562227
Iteration: 33, Cost function: 63949.022803
Iteration: 34, Cost function: 62912.247589
Iteration: 35, Cost function: 61860.178033
Iteration: 36, Cost function: 61027.155883
Iteration: 37, Cost function: 60084.648090
Iteration: 38, Cost function: 59485.958923
Iteration: 39, Cost function: 58622.490756
Iteration: 40, Cost function: 58246.565768
Iteration: 41, Cost function: 57406.512370
Iteration: 42, Cost function: 57167.132511
Iteration: 43, Cost function: 56298.932195
Iteration: 44, Cost function: 56082.029156
Iteration: 45, Cost function: 55173.726348
Iteration: 46, Cost function: 54921.582695
Iteration: 47, Cost function: 53987.101841
Iteration: 48, Cost function: 53702.801676
Iteration: 49, Cost function: 52757.401517
Iteration: 50, Cost function: 52462.737099
Iteration: 51, Cost function: 51518.052209
Iteration: 52, Cost function: 51232.268133
Iteration: 53, Cost function: 50295.530775
Iteration: 54, Cost function: 50033.143603
Iteration: 55, Cost function: 49106.723309
Iteration: 56, Cost function: 48879.527108
Iteration: 57, Cost function: 47961.912012
Iteration: 58, Cost function: 47780.242898
Iteration: 59, Cost function: 46867.690001
Iteration: 60, Cost function: 46740.637777
Iteration: 61, Cost function: 45828.758001
Iteration: 62, Cost function: 45763.692645
Iteration: 63, Cost function: 44848.764094
Iteration: 64, Cost function: 44850.425023
Iteration: 65, Cost function: 43930.415070
Iteration: 66, Cost function: 43999.762437
Iteration: 67, Cost function: 43075.017349
Iteration: 68, Cost function: 43208.159448
Iteration: 69, Cost function: 42281.655818
Iteration: 70, Cost function: 42469.351582
Iteration: 71, Cost function: 41546.406353
Iteration: 72, Cost function: 41774.685511
Iteration: 73, Cost function: 40862.154090
Iteration: 74, Cost function: 41114.263376
Iteration: 75, Cost function: 40219.469433
Iteration: 76, Cost function: 40478.663437
Iteration: 77, Cost function: 39608.429241
Iteration: 78, Cost function: 39860.553919
Iteration: 79, Cost function: 39020.602803
Iteration: 80, Cost function: 39255.523597
Iteration: 81, Cost function: 38450.284023
Iteration: 82, Cost function: 38661.938526
Iteration: 83, Cost function: 37894.601675
Iteration: 84, Cost function: 38080.153627
Iteration: 85, Cost function: 37352.822572
Iteration: 86, Cost function: 37511.572482
Iteration: 87, Cost function: 36825.418372
Iteration: 88, Cost function: 36957.890018
Iteration: 89, Cost function: 36313.297038
Iteration: 90, Cost function: 36420.621504
Iteration: 91, Cost function: 35817.325203
Iteration: 92, Cost function: 35900.878357
Iteration: 93, Cost function: 35338.099290
Iteration: 94, Cost function: 35399.309068
Iteration: 95, Cost function: 34875.877061
Iteration: 96, Cost function: 34916.134063
Iteration: 97, Cost function: 34430.596379
Iteration: 98, Cost function: 34451.226597
Iteration: 99, Cost function: 34001.935560
Iteration: 100, Cost function: 34004.210695
Iteration: 101, Cost function: 33589.390119
Iteration: 102, Cost function: 33574.558773
Iteration: 103, Cost function: 33192.351716
Iteration: 104, Cost function: 33161.678159
Iteration: 105, Cost function: 32810.180240
Iteration: 106, Cost function: 32764.979939
Iteration: 107, Cost function: 32442.262716
Iteration: 108, Cost function: 32383.926923
Iteration: 109, Cost function: 32088.055213
Iteration: 110, Cost function: 32018.060462
Iteration: 111, Cost function: 31747.106460
Iteration: 112, Cost function: 31667.008217
Iteration: 113, Cost function: 31419.064278
Iteration: 114, Cost function: 31330.476491
Iteration: 115, Cost function: 31103.667613
Iteration: 116, Cost function: 31008.231378
Iteration: 117, Cost function: 30800.727812
Iteration: 118, Cost function: 30700.072904
Iteration: 119, Cost function: 30510.102888
Iteration: 120, Cost function: 30405.805877
Iteration: 121, Cost function: 30231.668196
Iteration: 122, Cost function: 30125.210647
Iteration: 123, Cost function: 29965.286518
Iteration: 124, Cost function: 29858.016455
Iteration: 125, Cost function: 29710.780191
Iteration: 126, Cost function: 29603.879711
Iteration: 127, Cost function: 29467.907627
Iteration: 128, Cost function: 29362.369144
Iteration: 129, Cost function: 29236.346277
Iteration: 130, Cost function: 29132.959264
Iteration: 131, Cost function: 29015.683685
Iteration: 132, Cost function: 28915.032899
Iteration: 133, Cost function: 28805.417548
Iteration: 134, Cost function: 28707.892658
Iteration: 135, Cost function: 28604.964836
Iteration: 136, Cost function: 28510.780117
Iteration: 137, Cost function: 28413.678875
Iteration: 138, Cost function: 28322.900593
Iteration: 139, Cost function: 28230.872320
Iteration: 140, Cost function: 28143.450643
Iteration: 141, Cost function: 28055.843157
Iteration: 142, Cost function: 27971.645178
Iteration: 143, Cost function: 27887.900597
Iteration: 144, Cost function: 27806.741340
Iteration: 145, Cost function: 27726.387992
Iteration: 146, Cost function: 27648.056980
Iteration: 147, Cost function: 27570.700599
Iteration: 148, Cost function: 27494.982586
Iteration: 149, Cost function: 27420.297062
Iteration: 150, Cost function: 27346.986522
Iteration: 151, Cost function: 27274.704511
Iteration: 152, Cost function: 27203.614350
Iteration: 153, Cost function: 27133.518063
Iteration: 154, Cost function: 27064.483574
Iteration: 155, Cost function: 26996.396063
Iteration: 156, Cost function: 26929.275406
Iteration: 157, Cost function: 26863.052614
Iteration: 158, Cost function: 26797.725076
Iteration: 159, Cost function: 26733.248865
Iteration: 160, Cost function: 26669.611968
Iteration: 161, Cost function: 26606.784207
Iteration: 162, Cost function: 26544.750456
Iteration: 163, Cost function: 26483.488211
Iteration: 164, Cost function: 26422.981996
Iteration: 165, Cost function: 26363.213733
Iteration: 166, Cost function: 26304.168650
Iteration: 167, Cost function: 26245.831350
Iteration: 168, Cost function: 26188.188048
Iteration: 169, Cost function: 26131.225073
Iteration: 170, Cost function: 26074.929604
Iteration: 171, Cost function: 26019.289166
Iteration: 172, Cost function: 25964.291787
Iteration: 173, Cost function: 25909.925874
Iteration: 174, Cost function: 25856.180182
Iteration: 175, Cost function: 25803.043815
Iteration: 176, Cost function: 25750.506152
Iteration: 177, Cost function: 25698.556879
Iteration: 178, Cost function: 25647.185918
Iteration: 179, Cost function: 25596.383462
Iteration: 180, Cost function: 25546.139918
Iteration: 181, Cost function: 25496.445934
Iteration: 182, Cost function: 25447.292356
Iteration: 183, Cost function: 25398.670250
Iteration: 184, Cost function: 25350.570870
Iteration: 185, Cost function: 25302.985667
Iteration: 186, Cost function: 25255.906275
Iteration: 187, Cost function: 25209.324511
Iteration: 188, Cost function: 25163.232362
Iteration: 189, Cost function: 25117.621988
Iteration: 190, Cost function: 25072.485713
Iteration: 191, Cost function: 25027.816021
Iteration: 192, Cost function: 24983.605553
Iteration: 193, Cost function: 24939.847101
Iteration: 194, Cost function: 24896.533608
Iteration: 195, Cost function: 24853.658157
Iteration: 196, Cost function: 24811.213974
Iteration: 197, Cost function: 24769.194424
Iteration: 198, Cost function: 24727.593003
Iteration: 199, Cost function: 24686.403337
Iteration: 200, Cost function: 24645.619182
Iteration: 201, Cost function: 24605.234415
Iteration: 202, Cost function: 24565.243036
Iteration: 203, Cost function: 24525.639163
Iteration: 204, Cost function: 24486.417028
Iteration: 205, Cost function: 24447.570976
Iteration: 206, Cost function: 24409.095461
Iteration: 207, Cost function: 24370.985046
Iteration: 208, Cost function: 24333.234396
Iteration: 209, Cost function: 24295.838281
Iteration: 210, Cost function: 24258.791567
Iteration: 211, Cost function: 24222.089221
Iteration: 212, Cost function: 24185.726303
Iteration: 213, Cost function: 24149.697966
Iteration: 214, Cost function: 24113.999453
Iteration: 215, Cost function: 24078.626098
Iteration: 216, Cost function: 24043.573320
Iteration: 217, Cost function: 24008.836621
Iteration: 218, Cost function: 23974.411590
Iteration: 219, Cost function: 23940.293892
Iteration: 220, Cost function: 23906.479275
Iteration: 221, Cost function: 23872.963561
Iteration: 222, Cost function: 23839.742650
Iteration: 223, Cost function: 23806.812515
Iteration: 224, Cost function: 23774.169200
Iteration: 225, Cost function: 23741.808821
Iteration: 226, Cost function: 23709.727562
Iteration: 227, Cost function: 23677.921677
Iteration: 228, Cost function: 23646.387483
Iteration: 229, Cost function: 23615.121363
Iteration: 230, Cost function: 23584.119764
Iteration: 231, Cost function: 23553.379193
Iteration: 232, Cost function: 23522.896220
Iteration: 233, Cost function: 23492.667472
Iteration: 234, Cost function: 23462.689635
Iteration: 235, Cost function: 23432.959453
Iteration: 236, Cost function: 23403.473723
Iteration: 237, Cost function: 23374.229299
Iteration: 238, Cost function: 23345.223086
Iteration: 239, Cost function: 23316.452044
Iteration: 240, Cost function: 23287.913181
Iteration: 241, Cost function: 23259.603557
Iteration: 242, Cost function: 23231.520282
Iteration: 243, Cost function: 23203.660510
Iteration: 244, Cost function: 23176.021447
Iteration: 245, Cost function: 23148.600342
Iteration: 246, Cost function: 23121.394490
Iteration: 247, Cost function: 23094.401230
Iteration: 248, Cost function: 23067.617944
Iteration: 249, Cost function: 23041.042059
Iteration: 250, Cost function: 23014.671040
Iteration: 251, Cost function: 22988.502396
Iteration: 252, Cost function: 22962.533673
Iteration: 253, Cost function: 22936.762459
Iteration: 254, Cost function: 22911.186378
Iteration: 255, Cost function: 22885.803095
Iteration: 256, Cost function: 22860.610309
Iteration: 257, Cost function: 22835.605755
Iteration: 258, Cost function: 22810.787207
Iteration: 259, Cost function: 22786.152470
Iteration: 260, Cost function: 22761.699386
Iteration: 261, Cost function: 22737.425828
Iteration: 262, Cost function: 22713.329705
Iteration: 263, Cost function: 22689.408956
Iteration: 264, Cost function: 22665.661551
Iteration: 265, Cost function: 22642.085494
Iteration: 266, Cost function: 22618.678817
Iteration: 267, Cost function: 22595.439583
Iteration: 268, Cost function: 22572.365884
Iteration: 269, Cost function: 22549.455841
Iteration: 270, Cost function: 22526.707603
Iteration: 271, Cost function: 22504.119347
Iteration: 272, Cost function: 22481.689278
Iteration: 273, Cost function: 22459.415626
Iteration: 274, Cost function: 22437.296648
Iteration: 275, Cost function: 22415.330627
Iteration: 276, Cost function: 22393.515873
Iteration: 277, Cost function: 22371.850717
Iteration: 278, Cost function: 22350.333517
Iteration: 279, Cost function: 22328.962655
Iteration: 280, Cost function: 22307.736537
Iteration: 281, Cost function: 22286.653589
Iteration: 282, Cost function: 22265.712263
Iteration: 283, Cost function: 22244.911032
Iteration: 284, Cost function: 22224.248391
Iteration: 285, Cost function: 22203.722857
Iteration: 286, Cost function: 22183.332967
Iteration: 287, Cost function: 22163.077280
Iteration: 288, Cost function: 22142.954374
Iteration: 289, Cost function: 22122.962849
Iteration: 290, Cost function: 22103.101324
Iteration: 291, Cost function: 22083.368436
Iteration: 292, Cost function: 22063.762842
Iteration: 293, Cost function: 22044.283218
Iteration: 294, Cost function: 22024.928258
Iteration: 295, Cost function: 22005.696674
Iteration: 296, Cost function: 21986.587197
Iteration: 297, Cost function: 21967.598573
Iteration: 298, Cost function: 21948.729567
Iteration: 299, Cost function: 21929.978961
Iteration: 300, Cost function: 21911.345553
Iteration: 301, Cost function: 21892.828156
Iteration: 302, Cost function: 21874.425602
Iteration: 303, Cost function: 21856.136736
Iteration: 304, Cost function: 21837.960421
Iteration: 305, Cost function: 21819.895532
Iteration: 306, Cost function: 21801.940962
Iteration: 307, Cost function: 21784.095618
Iteration: 308, Cost function: 21766.358421
Iteration: 309, Cost function: 21748.728305
Iteration: 310, Cost function: 21731.204222
Iteration: 311, Cost function: 21713.785133
Iteration: 312, Cost function: 21696.470016
Iteration: 313, Cost function: 21679.257861
Iteration: 314, Cost function: 21662.147671
Iteration: 315, Cost function: 21645.138463
Iteration: 316, Cost function: 21628.229266
Iteration: 317, Cost function: 21611.419121
Iteration: 318, Cost function: 21594.707083
Iteration: 319, Cost function: 21578.092217
Iteration: 320, Cost function: 21561.573602
Iteration: 321, Cost function: 21545.150327
Iteration: 322, Cost function: 21528.821493
Iteration: 323, Cost function: 21512.586214
Iteration: 324, Cost function: 21496.443613
Iteration: 325, Cost function: 21480.392825
Iteration: 326, Cost function: 21464.432996
Iteration: 327, Cost function: 21448.563282
Iteration: 328, Cost function: 21432.782851
Iteration: 329, Cost function: 21417.090880
Iteration: 330, Cost function: 21401.486557
Iteration: 331, Cost function: 21385.969079
Iteration: 332, Cost function: 21370.537653
Iteration: 333, Cost function: 21355.191498
Iteration: 334, Cost function: 21339.929840
Iteration: 335, Cost function: 21324.751915
Iteration: 336, Cost function: 21309.656969
Iteration: 337, Cost function: 21294.644257
Iteration: 338, Cost function: 21279.713043
Iteration: 339, Cost function: 21264.862599
Iteration: 340, Cost function: 21250.092206
Iteration: 341, Cost function: 21235.401156
Iteration: 342, Cost function: 21220.788747
Iteration: 343, Cost function: 21206.254285
Iteration: 344, Cost function: 21191.797086
Iteration: 345, Cost function: 21177.416473
Iteration: 346, Cost function: 21163.111778
Iteration: 347, Cost function: 21148.882340
Iteration: 348, Cost function: 21134.727506
Iteration: 349, Cost function: 21120.646631
Iteration: 350, Cost function: 21106.639076
Iteration: 351, Cost function: 21092.704213
Iteration: 352, Cost function: 21078.841417
Iteration: 353, Cost function: 21065.050072
Iteration: 354, Cost function: 21051.329571
Iteration: 355, Cost function: 21037.679312
Iteration: 356, Cost function: 21024.098700
Iteration: 357, Cost function: 21010.587147
Iteration: 358, Cost function: 20997.144072
Iteration: 359, Cost function: 20983.768901
Iteration: 360, Cost function: 20970.461064
Iteration: 361, Cost function: 20957.220002
Iteration: 362, Cost function: 20944.045159
Iteration: 363, Cost function: 20930.935986
Iteration: 364, Cost function: 20917.891939
Iteration: 365, Cost function: 20904.912483
Iteration: 366, Cost function: 20891.997087
Iteration: 367, Cost function: 20879.145225
Iteration: 368, Cost function: 20866.356380
Iteration: 369, Cost function: 20853.630037
Iteration: 370, Cost function: 20840.965689
Iteration: 371, Cost function: 20828.362835
Iteration: 372, Cost function: 20815.820978
Iteration: 373, Cost function: 20803.339628
Iteration: 374, Cost function: 20790.918297
Iteration: 375, Cost function: 20778.556507
Iteration: 376, Cost function: 20766.253782
Iteration: 377, Cost function: 20754.009652
Iteration: 378, Cost function: 20741.823652
Iteration: 379, Cost function: 20729.695323
Iteration: 380, Cost function: 20717.624210
Iteration: 381, Cost function: 20705.609862
Iteration: 382, Cost function: 20693.651835
Iteration: 383, Cost function: 20681.749688
Iteration: 384, Cost function: 20669.902985
Iteration: 385, Cost function: 20658.111296
Iteration: 386, Cost function: 20646.374193
Iteration: 387, Cost function: 20634.691255
Iteration: 388, Cost function: 20623.062064
Iteration: 389, Cost function: 20611.486207
Iteration: 390, Cost function: 20599.963274
Iteration: 391, Cost function: 20588.492862
Iteration: 392, Cost function: 20577.074570
Iteration: 393, Cost function: 20565.708001
Iteration: 394, Cost function: 20554.392763
Iteration: 395, Cost function: 20543.128469
Iteration: 396, Cost function: 20531.914734
Iteration: 397, Cost function: 20520.751178
Iteration: 398, Cost function: 20509.637425
Iteration: 399, Cost function: 20498.573102
Iteration: 400, Cost function: 20487.557841
Iteration: 401, Cost function: 20476.591277
Iteration: 402, Cost function: 20465.673048
Iteration: 403, Cost function: 20454.802797
Iteration: 404, Cost function: 20443.980171
Iteration: 405, Cost function: 20433.204818
Iteration: 406, Cost function: 20422.476393
Iteration: 407, Cost function: 20411.794551
Iteration: 408, Cost function: 20401.158953
Iteration: 409, Cost function: 20390.569261
Iteration: 410, Cost function: 20380.025144
Iteration: 411, Cost function: 20369.526271
Iteration: 412, Cost function: 20359.072315
Iteration: 413, Cost function: 20348.662953
Iteration: 414, Cost function: 20338.297864
Iteration: 415, Cost function: 20327.976732
Iteration: 416, Cost function: 20317.699243
Iteration: 417, Cost function: 20307.465085
Iteration: 418, Cost function: 20297.273951
Iteration: 419, Cost function: 20287.125535
Iteration: 420, Cost function: 20277.019536
Iteration: 421, Cost function: 20266.955655
Iteration: 422, Cost function: 20256.933594
Iteration: 423, Cost function: 20246.953062
Iteration: 424, Cost function: 20237.013768
Iteration: 425, Cost function: 20227.115423
Iteration: 426, Cost function: 20217.257743
Iteration: 427, Cost function: 20207.440445
Iteration: 428, Cost function: 20197.663250
Iteration: 429, Cost function: 20187.925880
Iteration: 430, Cost function: 20178.228062
Iteration: 431, Cost function: 20168.569524
Iteration: 432, Cost function: 20158.949996
Iteration: 433, Cost function: 20149.369211
Iteration: 434, Cost function: 20139.826906
Iteration: 435, Cost function: 20130.322819
Iteration: 436, Cost function: 20120.856689
Iteration: 437, Cost function: 20111.428262
Iteration: 438, Cost function: 20102.037280
Iteration: 439, Cost function: 20092.683494
Iteration: 440, Cost function: 20083.366652
Iteration: 441, Cost function: 20074.086507
Iteration: 442, Cost function: 20064.842814
Iteration: 443, Cost function: 20055.635330
Iteration: 444, Cost function: 20046.463813
Iteration: 445, Cost function: 20037.328026
Iteration: 446, Cost function: 20028.227731
Iteration: 447, Cost function: 20019.162694
Iteration: 448, Cost function: 20010.132684
Iteration: 449, Cost function: 20001.137469
Iteration: 450, Cost function: 19992.176822
Iteration: 451, Cost function: 19983.250517
Iteration: 452, Cost function: 19974.358329
Iteration: 453, Cost function: 19965.500037
Iteration: 454, Cost function: 19956.675421
Iteration: 455, Cost function: 19947.884262
Iteration: 456, Cost function: 19939.126344
Iteration: 457, Cost function: 19930.401453
Iteration: 458, Cost function: 19921.709377
Iteration: 459, Cost function: 19913.049905
Iteration: 460, Cost function: 19904.422829
Iteration: 461, Cost function: 19895.827940
Iteration: 462, Cost function: 19887.265036
Iteration: 463, Cost function: 19878.733912
Iteration: 464, Cost function: 19870.234366
Iteration: 465, Cost function: 19861.766200
Iteration: 466, Cost function: 19853.329214
Iteration: 467, Cost function: 19844.923214
Iteration: 468, Cost function: 19836.548003
Iteration: 469, Cost function: 19828.203390
Iteration: 470, Cost function: 19819.889182
Iteration: 471, Cost function: 19811.605190
Iteration: 472, Cost function: 19803.351227
Iteration: 473, Cost function: 19795.127105
Iteration: 474, Cost function: 19786.932640
Iteration: 475, Cost function: 19778.767649
Iteration: 476, Cost function: 19770.631949
Iteration: 477, Cost function: 19762.525361
Iteration: 478, Cost function: 19754.447706
Iteration: 479, Cost function: 19746.398806
Iteration: 480, Cost function: 19738.378486
Iteration: 481, Cost function: 19730.386572
Iteration: 482, Cost function: 19722.422890
Iteration: 483, Cost function: 19714.487270
Iteration: 484, Cost function: 19706.579541
Iteration: 485, Cost function: 19698.699535
Iteration: 486, Cost function: 19690.847085
Iteration: 487, Cost function: 19683.022025
Iteration: 488, Cost function: 19675.224190
Iteration: 489, Cost function: 19667.453418
Iteration: 490, Cost function: 19659.709546
Iteration: 491, Cost function: 19651.992415
Iteration: 492, Cost function: 19644.301865
Iteration: 493, Cost function: 19636.637738
Iteration: 494, Cost function: 19628.999878
Iteration: 495, Cost function: 19621.388129
Iteration: 496, Cost function: 19613.802338
Iteration: 497, Cost function: 19606.242351
Iteration: 498, Cost function: 19598.708018
Iteration: 499, Cost function: 19591.199187
Iteration: 500, Cost function: 19583.715710


The error of the method is: 0.0874
